!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.mPage=n():e.mPage=n()}("undefined"!=typeof self?self:this,function(){return function(e){function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={data:function(){return{currentPage:1,pageSize:20,noData:!1,pageOpen:!0,pageLoading:!1,loadingEl:null}},directives:{page:{bind:function(e,n,t){var o=n.value,a=o.wrapperCls,i=o.childWrapperCls,r=o.callback,l=o.beforeCallback,c=o.afterCallback,s=o.throttleTime,u=o.loadingOpen,d=o.loadFirst,p=void 0,g=void 0,f=e.childNodes[0],h=t.context;!i&&a&&(i=a),!1!==u&&h.genLoading(e),i&&f&&f.classList.contains(i)?(1===h.currentPage&&!1!==d&&h.doCallback(r,l,c),e.addEventListener("touchmove",h.throttle(function(){p=e.offsetHeight,g=f.offsetHeight,!h.pageLoading&&!h.noData&&g>p&&p+e.scrollTop>=g&&h.doCallback(r,l,c)},s||500),{trailing:!0,leading:!0})):console.error("you should give child wrapper class name")}}},watch:{pageLoading:function(e){return this.loadingShow(e),e}},methods:{doCallback:function(e,n,t){var o=this;n&&n(),this.pageOpen&&(this.pageLoading=!0,this.pageOpen=!1,e&&e(function(e){o.pageOpen=!0,o.pageLoading=!1,e instanceof Array?(o.noData=0===e.length&&o.currentPage>1,t&&t(o.noData),o.noData&&o.$nextTick().then(function(){o.loadingShow(!0,"没有更多了")})):console.error("params type must be an Array for page callback"),o.currentPage++}))},resetPage:function(){this.currentPage=1,this.pageSize=20,this.noData=!1,this.pageLoading=!1,this.pageOpen=!0},genLoading:function(e){var n=document.createElement("p");n.style.cssText="text-align:center;line-height:40px;color:#999;font-size:14px;display:none;",this.loadingEl=n,e.appendChild(n)},loadingShow:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"加载中...";if(this.loadingEl){this.loadingEl.innerText=n,this.loadingEl.style.display=e?"":"none";var t=this.loadingEl.parentNode;t.scrollTop=t.scrollTop+this.loadingEl.offsetHeight}},throttle:function(e,n,t){var o=void 0,a=void 0,i=void 0,r=void 0,l=0;t||(t={});var c=function(){l=!1===t.leading?0:Date.now(),o=null,r=e.apply(a,i),o||(a=i=null)},s=function(){var s=Date.now();l||!1!==t.leading||(l=s);var u=n-(s-l);return a=this,i=arguments,u<=0||u>n?(o&&(clearTimeout(o),o=null),l=s,r=e.apply(a,i),o||(a=i=null)):o||!1===t.trailing||(o=setTimeout(c,u)),r};return s.cancel=function(){clearTimeout(o),l=0,o=a=i=null},s}}}}])});
//# sourceMappingURL=mPage.js.map